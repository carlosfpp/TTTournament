<!DOCTYPE html>
<html>
<head>
    <title>Campeonato de Tenis de Mesa</title>
    <style>
        /* Estilos CSS para una apariencia básica */
        body {
            font-family: Arial, sans-serif;
        }
        .container {
            margin: 20px;
        }
        .round {
            margin-bottom: 20px;
        }
        table {
            border-collapse: collapse;
        }
        th, td {
            padding: 8px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background-color: #f2f2f2;
        }
        .form-group {
            margin-bottom: 10px;
        }
        .button {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 14px;
            margin-top: 10px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Campeonato de Tenis de Mesa</h1>
        <div id="input-section">
            <h2>Introduce los nombres de los jugadores:</h2>
            <div class="form-group">
                <input type="text" id="player-name" placeholder="Nombre y Apellido">
                <button onclick="addPlayer()">Agregar jugador</button>
            </div>
            <div id="player-list"></div>
            <button onclick="startTournament()">Iniciar torneo</button>
        </div>
        <div id="tournament-section" style="display: none;">
            <h2>Rondas</h2>
            <div id="rounds"></div>
            <h2>Ranking final</h2>
            <table id="ranking-table">
                <thead>
                    <tr>
                        <th>Posición</th>
                        <th>Jugador</th>
                        <th>Partidos ganados</th>
                    </tr>
                </thead>
                <tbody id="ranking-body"></tbody>
            </table>
        </div>
    </div>

    <script>
        let players = [];

        function addPlayer() {
            const playerNameInput = document.getElementById('player-name');
            const playerName = playerNameInput.value.trim();

            if (playerName !== '') {
                players.push({ name: playerName, victories: 0 });
                playerNameInput.value = '';
                renderPlayerList();
            }
        }

        function renderPlayerList() {
            const playerListDiv = document.getElementById('player-list');
            playerListDiv.innerHTML = '';

            players.forEach((player, index) => {
                const playerItem = document.createElement('div');
                playerItem.textContent = player.name;
                playerListDiv.appendChild(playerItem);
            });
        }

        function startTournament() {
            if (players.length < 2) {
                alert('Debes ingresar al menos 2 jugadores para iniciar el torneo.');
                return;
            }

            document.getElementById('input-section').style.display = 'none';
            document.getElementById('tournament-section').style.display = 'block';

            const roundsDiv = document.getElementById('rounds');
            const rankingBody = document.getElementById('ranking-body');

            const roundCount = Math.floor(players.length / 2);
            const partidosGanados = {};

            players.forEach((player) => {
                partidosGanados[player.name] = player.victories;
            });

            const roundHeader = document.createElement('h3');
            roundHeader.textContent = 'Ronda 1';
            roundsDiv.appendChild(roundHeader);

            const roundMatches = generarEnfrentamientos(players, partidosGanados);

            const roundTable = document.createElement('table');
            roundTable.innerHTML = '<tr><th>Jugador 1</th><th>Jugador 2</th><th>Ganador</th></tr>';

            roundMatches.forEach((match) => {
                const matchRow = document.createElement('tr');
                matchRow.innerHTML = '<td>' + match[0].name + '</td><td>' + match[1].name + '</td>';

                const winnerCell = document.createElement('td');
                const winnerInput = document.createElement('input');
                winnerInput.setAttribute('type', 'text');
                winnerInput.setAttribute('placeholder', 'Nombre del ganador');
                matchRow.appendChild(winnerCell);
                winnerCell.appendChild(winnerInput);

                roundTable.appendChild(matchRow);
            });

            const nextButton = document.createElement('button');
            nextButton.textContent = 'Siguiente ronda';
            nextButton.addEventListener('click', function () {
                const winnerInputs = roundTable.querySelectorAll('input');
                let allWinnersEntered = true;

                winnerInputs.forEach(function (input) {
                    if (input.value.trim() === '') {
                        allWinnersEntered = false;
                        return;
                    }
                });

                if (!allWinnersEntered) {
                    alert('Debes ingresar el nombre del ganador para cada enfrentamiento.');
                    return;
                }

                winnerInputs.forEach(function (input, index) {
                    const winnerName = input.value.trim();
                    const match = roundMatches[index];

                    if (match[0].name === winnerName) {
                        match[0].victories++;
                        partidosGanados[match[0].name]++;
                    } else if (match[1].name === winnerName) {
                        match[1].victories++;
                        partidosGanados[match[1].name]++;
                    }
                });

                roundsDiv.innerHTML = '';
                rankingBody.innerHTML = '';

                if (roundCount > 1) {
                    for (let ronda = 2; ronda <= roundCount; ronda++) {
                        const roundHeader = document.createElement('h3');
                        roundHeader.textContent = 'Ronda ' + ronda;
                        roundsDiv.appendChild(roundHeader);

                        const roundMatches = generarEnfrentamientos(players, partidosGanados, ronda);

                        const roundTable = document.createElement('table');
                        roundTable.innerHTML = '<tr><th>Jugador 1</th><th>Jugador 2</th><th>Ganador</th></tr>';

                        roundMatches.forEach((match) => {
                            const matchRow = document.createElement('tr');
                            matchRow.innerHTML = '<td>' + match[0].name + '</td><td>' + match[1].name + '</td>';

                            const winnerCell = document.createElement('td');
                            const winnerInput = document.createElement('input');
                            winnerInput.setAttribute('type', 'text');
                            winnerInput.setAttribute('placeholder', 'Nombre del ganador');
                            matchRow.appendChild(winnerCell);
                            winnerCell.appendChild(winnerInput);

                            roundTable.appendChild(matchRow);
                        });

                        const nextButton = document.createElement('button');
                        nextButton.textContent = 'Siguiente ronda';
                        nextButton.addEventListener('click', function () {
                            const winnerInputs = roundTable.querySelectorAll('input');
                            let allWinnersEntered = true;

                            winnerInputs.forEach(function (input) {
                                                                if (input.value.trim() === '') {
                                    allWinnersEntered = false;
                                    return;
                                }
                            });

                            if (!allWinnersEntered) {
                                alert('Debes ingresar el nombre del ganador para cada enfrentamiento.');
                                return;
                            }

                            winnerInputs.forEach(function (input, index) {
                                const winnerName = input.value.trim();
                                const match = roundMatches[index];

                                if (match[0].name === winnerName) {
                                    match[0].victories++;
                                    partidosGanados[match[0].name]++;
                                } else if (match[1].name === winnerName) {
                                    match[1].victories++;
                                    partidosGanados[match[1].name]++;
                                }
                            });

                            roundsDiv.innerHTML = '';
                            rankingBody.innerHTML = '';

                            if (ronda < roundCount) {
                                for (let i = 0; i < ronda; i++) {
                                    const roundHeader = document.createElement('h3');
                                    roundHeader.textContent = 'Ronda ' + (ronda + i);
                                    roundsDiv.appendChild(roundHeader);

                                    const roundMatches = generarEnfrentamientos(players, partidosGanados, ronda + i);

                                    const roundTable = document.createElement('table');
                                    roundTable.innerHTML = '<tr><th>Jugador 1</th><th>Jugador 2</th><th>Ganador</th></tr>';

                                    roundMatches.forEach((match) => {
                                        const matchRow = document.createElement('tr');
                                        matchRow.innerHTML = '<td>' + match[0].name + '</td><td>' + match[1].name + '</td>';

                                        const winnerCell = document.createElement('td');
                                        const winnerInput = document.createElement('input');
                                        winnerInput.setAttribute('type', 'text');
                                        winnerInput.setAttribute('placeholder', 'Nombre del ganador');
                                        matchRow.appendChild(winnerCell);
                                        winnerCell.appendChild(winnerInput);

                                        roundTable.appendChild(matchRow);
                                    });

                                    const nextButton = document.createElement('button');
                                    nextButton.textContent = 'Siguiente ronda';
                                    nextButton.addEventListener('click', function () {
                                        const winnerInputs = roundTable.querySelectorAll('input');
                                        let allWinnersEntered = true;

                                        winnerInputs.forEach(function (input) {
                                            if (input.value.trim() === '') {
                                                allWinnersEntered = false;
                                                return;
                                            }
                                        });

                                        if (!allWinnersEntered) {
                                            alert('Debes ingresar el nombre del ganador para cada enfrentamiento.');
                                            return;
                                        }

                                        winnerInputs.forEach(function (input, index) {
                                            const winnerName = input.value.trim();
                                            const match = roundMatches[index];

                                            if (match[0].name === winnerName) {
                                                match[0].victories++;
                                                partidosGanados[match[0].name]++;
                                            } else if (match[1].name === winnerName) {
                                                match[1].victories++;
                                                partidosGanados[match[1].name]++;
                                            }
                                        });

                                        roundsDiv.innerHTML = '';
                                        rankingBody.innerHTML = '';

                                        if (ronda + i + 1 < roundCount) {
                                            for (let j = 0; j <= i; j++) {
                                                const roundHeader = document.createElement('h3');
                                                roundHeader.textContent = 'Ronda ' + (ronda + i + 1 + j);
                                                roundsDiv.appendChild(roundHeader);

                                                const roundMatches = generarEnfrentamientos(players, partidosGanados, ronda + i + 1 + j);

                                                const roundTable = document.createElement('table');
                                                roundTable.innerHTML = '<tr><th>Jugador 1</th><th>Jugador 2</th><th>Ganador</th></tr>';

                                                roundMatches.forEach((match) => {
                                                    const matchRow = document.createElement('tr');
                                                    matchRow.innerHTML = '<td>' + match[0].name + '</td><td>' + match[1].name + '</td>';

                                                    const winnerCell = document.createElement('td');
                                                    const winnerInput = document.createElement('input');
                                                    winnerInput.setAttribute('type', 'text');
                                                    winnerInput.setAttribute('placeholder', 'Nombre del ganador');
                                                    matchRow.appendChild(winnerCell);
                                                    winnerCell.appendChild(winnerInput);

                                                    roundTable.appendChild(matchRow);
                                                });

                                                const nextButton = document.createElement('button');
                                                nextButton.textContent = 'Siguiente ronda';
                                                nextButton.addEventListener('click', function () {
                                                    const winnerInputs = roundTable.querySelectorAll('input');
                                                    let allWinnersEntered = true;

                                                    winnerInputs.forEach(function (input) {
                                                        if (input.value.trim() === '') {
                                                            allWinnersEntered = false;
                                                            return;
                                                        }
                                                    });

                                                    if (!allWinnersEntered) {
                                                        alert('Debes ingresar el nombre del ganador para cada enfrentamiento.');
                                                        return;
                                                    }

                                                    winnerInputs.forEach(function (input, index) {
                                                        const winnerName = input.value.trim();
                                                        const match = roundMatches[index];

                                                        if (match[0].name === winnerName) {
                                                            match[0].victories++;
                                                            partidosGanados[match[0].name]++;
                                                        } else if (match[1].name === winnerName) {
                                                            match[1].victories++;
                                                            partidosGanados[match[1].name]++;
                                                        }
                                                    });

                                                    roundsDiv.innerHTML = '';
                                                    rankingBody.innerHTML = '';

                                                    if (ronda + i + 1 + j + 1 === roundCount) {
                                                                                                                const roundHeader = document.createElement('h3');
                                                        roundHeader.textContent = 'Ronda ' + (ronda + i + 1 + j + 1);
                                                        roundsDiv.appendChild(roundHeader);

                                                        const roundMatches = generarEnfrentamientos(players, partidosGanados, ronda + i + 1 + j + 1);

                                                        const roundTable = document.createElement('table');
                                                        roundTable.innerHTML = '<tr><th>Jugador 1</th><th>Jugador 2</th><th>Ganador</th></tr>';

                                                        roundMatches.forEach((match) => {
                                                            const matchRow = document.createElement('tr');
                                                            matchRow.innerHTML = '<td>' + match[0].name + '</td><td>' + match[1].name + '</td>';

                                                            const winnerCell = document.createElement('td');
                                                            const winnerInput = document.createElement('input');
                                                            winnerInput.setAttribute('type', 'text');
                                                            winnerInput.setAttribute('placeholder', 'Nombre del ganador');
                                                            matchRow.appendChild(winnerCell);
                                                            winnerCell.appendChild(winnerInput);

                                                            roundTable.appendChild(matchRow);
                                                        });

                                                        const nextButton = document.createElement('button');
                                                        nextButton.textContent = 'Finalizar torneo';
                                                        nextButton.addEventListener('click', function () {
                                                            const winnerInputs = roundTable.querySelectorAll('input');
                                                            let allWinnersEntered = true;

                                                            winnerInputs.forEach(function (input) {
                                                                if (input.value.trim() === '') {
                                                                    allWinnersEntered = false;
                                                                    return;
                                                                }
                                                            });

                                                            if (!allWinnersEntered) {
                                                                alert('Debes ingresar el nombre del ganador para cada enfrentamiento.');
                                                                return;
                                                            }

                                                            winnerInputs.forEach(function (input, index) {
                                                                const winnerName = input.value.trim();
                                                                const match = roundMatches[index];

                                                                if (match[0].name === winnerName) {
                                                                    match[0].victories++;
                                                                    partidosGanados[match[0].name]++;
                                                                } else if (match[1].name === winnerName) {
                                                                    match[1].victories++;
                                                                    partidosGanados[match[1].name]++;
                                                                }
                                                            });

                                                            roundsDiv.innerHTML = '';
                                                            rankingBody.innerHTML = '';

                                                            const sortedPlayers = players.sort((a, b) => b.victories - a.victories);

                                                            sortedPlayers.forEach((player, index) => {
                                                                const row = document.createElement('tr');
                                                                row.innerHTML = '<td>' + (index + 1) + '</td><td>' + player.name + '</td><td>' + player.victories + '</td>';
                                                                rankingBody.appendChild(row);
                                                            });
                                                        });

                                                        roundsDiv.appendChild(roundTable);
                                                        roundsDiv.appendChild(nextButton);
                                                    }
                                                });

                                                roundsDiv.appendChild(roundTable);
                                                roundsDiv.appendChild(nextButton);
                                            }
                                        }
                                    });

                                    roundsDiv.appendChild(roundTable);
                                    roundsDiv.appendChild(nextButton);
                                }
                            }
                        });

                        roundsDiv.appendChild(roundTable);
                        roundsDiv.appendChild(nextButton);
                    }
                }

                roundsDiv.appendChild(roundTable);
                roundsDiv.appendChild(nextButton);
            });

            roundsDiv.appendChild(roundTable);
            roundsDiv.appendChild(nextButton);
        }

        function generarEnfrentamientos(players, partidosGanados, ronda = 1) {
            const matches = [];

            const sortedPlayers = players.sort((a, b) => partidosGanados[a.name] - partidosGanados[b.name]);

            const matchesCount = Math.floor(sortedPlayers.length / 2);

            for (let i = 0; i < matchesCount; i++) {
                const player1 = sortedPlayers[i];
                const player2 = sortedPlayers[i + matchesCount];

                matches.push([player1, player2]);
            }

            return matches;
        }
    </script>
</body>
</html>


